(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var cururl = window.location.origin;
var socket = io(cururl, { forceNew: true });

var app = angular.module('myApp', []);
app.directive("forgotPassword", function ($rootScope, $http) {
    return {
        // templateurl:  '<div>A Custom Directive <br> <b ng-show="directiveCtrlCalled">directiveCtrl() was called!!</b> </div>',
        templateUrl: "/admin/ngViews/forgotpassword.html",
        //templateUrl: "/login/public/views/forgotpassword.html",
        restrict: "E",
        replace: true,
        scope: { options: "=" },
        link: function link(scope) {
            scope.directiveCtrlCalled = false;
            var UserInfo;
            scope.sendotp = function () {
                scope.validateotp();
            };
            scope.$on("UserInfo", function (evt, data) {
                UserInfo = data;
            });
            scope.$on("loginshow", function (evt, data) {
                scope.directiveCtrlCalled = false;
                scope.createNewPassword = false;
            });
            angular.extend(scope.options, {
                directiveFunction: function directiveFunction() {
                    scope.directiveCtrlCalled = true;
                    scope.emailid = UserInfo.email;
                    var res = UserInfo.email.split("@");
                    var email = '';
                    angular.forEach(res[1], function (value, key) {
                        email += 'x';
                    });
                    scope.eemailid = res[0] + '@' + email;
                    $rootScope.$broadcast('Email', scope.eemailid);
                }
            });
            scope.cancelforgotpass = function () {
                $rootScope.$broadcast('forgotcancel', true);
            };
            scope.$on("forgotcancel", function (evt, data) {
                scope.directiveCtrlCalled = false;
            });
            scope.reset = function () {
                scope.otpform.$setPristine();
                scope.eemailid = '';
                scope.emailid = '';
            };
            scope.validateotp = function () {
                try {

                    if (scope.emailid) {
                        if (typeof scope.emailid == "undefined") {
                            alert("Please Fill Email Id");
                            return;
                        }
                    }

                    $http.post("/sendmail", { "EmailId": scope.emailid, "UserId": UserInfo.userid }).then(function (response) {
                        if (response.data == 'sucsess') {
                            scope.directiveCtrlCalled = false;
                            scope.createNewPassword = true;
                            $rootScope.$broadcast('UserInfo1', UserInfo);
                            alert('Verification Mail Send Sucsessfully');
                        } else {
                            alert('Verification Mail  Send Fail');
                        }
                    });
                } catch (e) {
                    return false;
                }
            };
        }
    };
});
app.directive("createNewPassword", function ($rootScope, $http) {
    return {
        // templateurl:  '<div>A Custom Directive <br> <b ng-show="directiveCtrlCalled">directiveCtrl() was called!!</b> </div>',
        templateUrl: "/admin/ngViews/createNewPassword.html",
        //templateUrl: "/login/public/views/createNewPassword.html",
        restrict: "E",
        replace: true,
        scope: { options: "&" },
        link: function link(scope, elements, attributes) {
            var UserInfo;
            scope.createNewPassword = false;
            scope.$on("UserInfo1", function (evt, data) {
                UserInfo = data;
                scope.cemailid = UserInfo.email;
            });
            scope.$on("Email", function (evt, data) {
                scope.reset();
                scope.ceemailid = data;
            });
            scope.resendotp = function () {
                scope.validateresendotp();
            };
            scope.changepassword = function () {
                scope.changepasswordsubmit();
            };
            angular.extend(scope.options, {
                directiveFunction: function directiveFunction() {}
            });
            scope.reset = function () {
                scope.changepassform.$setPristine();
                scope.cemailid = '';
                scope.ceemailid = '';
                scope.cpassword = '';
                scope.conpassword = '';
                scope.otp = '';
            };
            scope.validateresendotp = function () {
                try {

                    if (scope.cemailid) {
                        if (typeof scope.cemailid == "undefined") {
                            alert("Please Fill Email Id");
                            return;
                        }
                    }

                    $http.post("/sendmail", { "EmailId": scope.cemailid, "UserId": UserInfo.userid }).then(function (response) {
                        if (response.data == 'sucsess') {
                            //$rootScope.$broadcast('UserInfo1', UserInfo);
                            alert('Verification Mail Re Send Sucsessful');
                        } else {
                            alert('Verification Mail Re Send Fail');
                        }
                    });
                } catch (e) {
                    return false;
                }
            };
            scope.cancelmail = function () {
                $rootScope.$broadcast('loginshow', true);
            };
            scope.changepasswordsubmit = function () {
                try {
                    $http.post("/resetpassword", { "EmailId": scope.cemailid, "UserId": UserInfo.userid, "password": scope.conpassword, "OtpCode": scope.otp }).then(function (response) {
                        if (response.data.toString() == 'sucsess') {
                            $rootScope.$broadcast('loginshow', true);
                            alert('Reset Password Sucsessful');
                            //window.location.reload();
                        } else if (response.data.toString() == 'Expire') {
                            alert('OTP Is Expired');
                        } else {
                            alert('Reset Password Fail');
                        }
                    });
                } catch (e) {
                    return false;
                }
            };
        }
    };
});
app.controller('myCtrl', function ($scope, $http, $log, $rootScope) {
    $scope.dirOptions = {};
    $scope.callDirFunc = function () {
        if (typeof $scope.userid == 'undefined' || $scope.userid == '') {
            $scope.msg = 'UserId is Required';
            return false;
        }
        $scope.forgote = false;
        $scope.dirOptions.directiveFunction();
        $scope.loginshow = false;
    };
    $scope.$on("loginshow", function (evt, data) {
        UserInfo = data;
        $scope.loginshow = UserInfo;
    });
    $scope.$on("forgotcancel", function (evt, data) {

        $scope.loginshow = true;
    });
    $scope.loginshow = true;
    $scope.isloginDisable = true;
    $scope.isMultirole = false;
    $scope.clusters = [];
    $scope.usercluster = "";
    $scope.lastlogin = "";
    $scope.forgote = false;
    $scope.Validate = function () {
        try {

            if ($scope.isMultirole) {
                if (typeof $scope.selectedrole == "undefined") {
                    alert("Please select role");
                    $("#userrole").focus();
                    return;
                }
            }

            $http.post("/validate", { "userid": $scope.userid, "pass": $scope.pass }).then(function (response) {
                debugger;
                $log.info(response);
                if (response.data == "1" || response.data == "2") {
                    alert("Invalid password");
                    $("#pass").focus();
                    return false;
                } else if (response.data == "3") {
                    alert("Another User is already logged In, kindly close the current session or use another browser.");
                    return false;
                } else {
                    document.getElementById('roleid').value = $scope.selectedrole.Roleid;
                    document.getElementById('rolename').value = $scope.selectedrole.Rolename;
                    $("#loginForm").submit();
                    socket.emit('connecteduser', $scope.userid, $scope.usercluster, $scope.lastlogin);
                }
            });
        } catch (e) {
            return false;
        }
    };

    $scope.GetUserRole = function () {
        try {

            if (typeof $scope.userid != "undefined") {
                $scope.msg = '';
                $http.post("/FetchUserInfo", { "userid": $scope.userid }).then(function (response) {
                    if (response.data == "1" || response.data == "2") {
                        alert("Invalid user id");
                        return false;
                    } else {
                        $rootScope.$broadcast('UserInfo', response.data[0]);
                        $scope.forgote = true;
                        $scope.lastlogin = response.data[0].lastlogin;
                        $scope.clusters = response.data[0].clusters;
                        if (response.data[0].role.length == 1) {
                            $scope.isMultirole = false;
                            $scope.isloginDisable = false;
                            $scope.selectedrole = response.data[0].role[0];
                        } else if (response.data[0].role.length > 1) {
                            $scope.isMultirole = true;
                            $scope.UserRoles = response.data[0].role;
                            $scope.isloginDisable = false;
                        }
                        $scope.usercluster = GetUserCluster($scope.clusters);
                    }
                });
            }
        } catch (e) {
            return false;
        }
    };

    function GetUserCluster(clusters) {
        var userclusters = "";
        clusters.forEach(function (item) {
            if (userclusters == "") userclusters = item;else userclusters = userclusters + "," + item;
        });
        return userclusters;
    };
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwdWJsaWMvbG9naW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0NRLElBQUksU0FBUyxPQUFPLFFBQVAsQ0FBZ0IsTUFBN0I7QUFDQSxJQUFJLFNBQVMsR0FBRyxNQUFILEVBQVcsRUFBRSxVQUFVLElBQVosRUFBWCxDQUFiOztBQUVBLElBQUksTUFBTSxRQUFRLE1BQVIsQ0FBZSxPQUFmLEVBQXdCLEVBQXhCLENBQVY7QUFDQSxJQUFJLFNBQUosQ0FBYyxnQkFBZCxFQUFnQyxVQUFVLFVBQVYsRUFBc0IsS0FBdEIsRUFBNkI7QUFDekQsV0FBTztBQUNIO0FBQ0EscUJBQWEsb0NBRlY7QUFHSDtBQUNBLGtCQUFVLEdBSlA7QUFLSCxpQkFBUyxJQUxOO0FBTUgsZUFBTyxFQUFFLFNBQVMsR0FBWCxFQU5KO0FBT0gsY0FBTSxjQUFVLEtBQVYsRUFBaUI7QUFDbkIsa0JBQU0sbUJBQU4sR0FBNEIsS0FBNUI7QUFDQSxnQkFBSSxRQUFKO0FBQ0Esa0JBQU0sT0FBTixHQUFnQixZQUFZO0FBQ3hCLHNCQUFNLFdBQU47QUFDSCxhQUZEO0FBR0Esa0JBQU0sR0FBTixDQUFVLFVBQVYsRUFBc0IsVUFBVSxHQUFWLEVBQWUsSUFBZixFQUFxQjtBQUN2QywyQkFBVyxJQUFYO0FBQ0gsYUFGRDtBQUdBLGtCQUFNLEdBQU4sQ0FBVSxXQUFWLEVBQXVCLFVBQVUsR0FBVixFQUFlLElBQWYsRUFBcUI7QUFDeEMsc0JBQU0sbUJBQU4sR0FBNEIsS0FBNUI7QUFDQSxzQkFBTSxpQkFBTixHQUEwQixLQUExQjtBQUNILGFBSEQ7QUFJQSxvQkFBUSxNQUFSLENBQWUsTUFBTSxPQUFyQixFQUE4QjtBQUMxQixtQ0FBbUIsNkJBQVk7QUFDM0IsMEJBQU0sbUJBQU4sR0FBNEIsSUFBNUI7QUFDQSwwQkFBTSxPQUFOLEdBQWdCLFNBQVMsS0FBekI7QUFDQSx3QkFBSSxNQUFNLFNBQVMsS0FB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Q0FBYyxDQUFkLEVBQWlCLElBQWpCLENBQXNCLE1BQXRCLEdBQStCLENBQW5DLEVBQXNDO0FBQ3ZDLG1DQUFPLFdBQVAsR0FBcUIsSUFBckI7QUFDQSxtQ0FBTyxTQUFQLEdBQW1CLFNBQVMsSUFBVCxDQUFjLENBQWQsRUFBaUIsSUFBcEM7QUFDQSxtQ0FBTyxjQUFQLEdBQXdCLEtBQXhCO0FBQ0g7QUFDRCwrQkFBTyxXQUFQLEdBQXFCLGVBQWUsT0FBTyxRQUF0QixDQUFyQjtBQUNIO0FBQ0osaUJBdkJMO0FBd0JIO0FBQ0osU0E3QkQsQ0E2QkUsT0FBTyxDQUFQLEVBQVU7QUFDUixtQkFBTyxLQUFQO0FBQ0g7QUFFSixLQWxDRDs7QUFvQ0EsYUFBUyxjQUFULENBQXdCLFFBQXhCLEVBQWtDO0FBQzlCLFlBQUksZUFBZSxFQUFuQjtBQUNBLGlCQUFTLE9BQVQsQ0FBaUIsZ0JBQVE7QUFDckIsZ0JBQUksZ0JBQWdCLEVBQXBCLEVBQ0ksZUFBZSxJQUFmLENBREosS0FHSSxlQUFlLGVBQWUsR0FBZixHQUFxQixJQUFwQztBQUNQLFNBTEQ7QUFNQSxlQUFPLFlBQVA7QUFDSDtBQUVKLENBN0dEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiICBcclxuICAgICAgICB2YXIgY3VydXJsID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbjtcclxuICAgICAgICB2YXIgc29ja2V0ID0gaW8oY3VydXJsLCB7IGZvcmNlTmV3OiB0cnVlIH0pO1xyXG5cclxuICAgICAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJywgW10pO1xyXG4gICAgICAgIGFwcC5kaXJlY3RpdmUoXCJmb3Jnb3RQYXNzd29yZFwiLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJGh0dHApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIC8vIHRlbXBsYXRldXJsOiAgJzxkaXY+QSBDdXN0b20gRGlyZWN0aXZlIDxicj4gPGIgbmctc2hvdz1cImRpcmVjdGl2ZUN0cmxDYWxsZWRcIj5kaXJlY3RpdmVDdHJsKCkgd2FzIGNhbGxlZCEhPC9iPiA8L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiL2FkbWluL25nVmlld3MvZm9yZ290cGFzc3dvcmQuaHRtbFwiLFxyXG4gICAgICAgICAgICAgICAgLy90ZW1wbGF0ZVVybDogXCIvbG9naW4vcHVibGljL3ZpZXdzL2ZvcmdvdHBhc3N3b3JkLmh0bWxcIixcclxuICAgICAgICAgICAgICAgIHJlc3RyaWN0OiBcIkVcIixcclxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBzY29wZTogeyBvcHRpb25zOiBcIj1cIiB9LFxyXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGlyZWN0aXZlQ3RybENhbGxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBVc2VySW5mbztcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5zZW5kb3RwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52YWxpZGF0ZW90cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oXCJVc2VySW5mb1wiLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJbmZvID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oXCJsb2dpbnNob3dcIiwgZnVuY3Rpb24gKGV2dCwgZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kaXJlY3RpdmVDdHJsQ2FsbGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNyZWF0ZU5ld1Bhc3N3b3JkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoc2NvcGUub3B0aW9ucywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmVGdW5jdGlvbjogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGlyZWN0aXZlQ3RybENhbGxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5lbWFpbGlkID0gVXNlckluZm8uZW1haWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gVXNlckluZm8uZW1haWwuc3BsaXQoXCJAXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVtYWlsID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gocmVzWzFdLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsICs9ICd4JztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZWVtYWlsaWQgPSByZXNbMF0gKyAnQCcgKyBlbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnRW1haWwnLCBzY29wZS5lZW1haWxpZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5jYW5jZWxmb3Jnb3RwYXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2ZvcmdvdGNhbmNlbCcsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oXCJmb3Jnb3RjYW5jZWxcIiwgZnVuY3Rpb24gKGV2dCwgZGF0YSkgeyAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kaXJlY3RpdmVDdHJsQ2FsbGVkID0gZmFsc2U7ICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm90cGZvcm0uJHNldFByaXN0aW5lKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmVlbWFpbGlkID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmVtYWlsaWQgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudmFsaWRhdGVvdHAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmVtYWlsaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChzY29wZS5lbWFpbGlkKSA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIEZpbGwgRW1haWwgSWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAucG9zdChcIi9zZW5kbWFpbFwiLCB7IFwiRW1haWxJZFwiOiBzY29wZS5lbWFpbGlkLCBcIlVzZXJJZFwiOiBVc2VySW5mby51c2VyaWQgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gJ3N1Y3Nlc3MnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kaXJlY3RpdmVDdHJsQ2FsbGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jcmVhdGVOZXdQYXNzd29yZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ1VzZXJJbmZvMScsIFVzZXJJbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdWZXJpZmljYXRpb24gTWFpbCBTZW5kIFN1Y3Nlc3NmdWxseScpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7IGFsZXJ0KCdWZXJpZmljYXRpb24gTWFpbCAgU2VuZCBGYWlsJykgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGFwcC5kaXJlY3RpdmUoXCJjcmVhdGVOZXdQYXNzd29yZFwiLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJGh0dHApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIC8vIHRlbXBsYXRldXJsOiAgJzxkaXY+QSBDdXN0b20gRGlyZWN0aXZlIDxicj4gPGIgbmctc2hvdz1cImRpcmVjdGl2ZUN0cmxDYWxsZWRcIj5kaXJlY3RpdmVDdHJsKCkgd2FzIGNhbGxlZCEhPC9iPiA8L2Rpdj4nLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiL2FkbWluL25nVmlld3MvY3JlYXRlTmV3UGFzc3dvcmQuaHRtbFwiLFxyXG4gICAgICAgICAgICAgICAgLy90ZW1wbGF0ZVVybDogXCIvbG9naW4vcHVibGljL3ZpZXdzL2NyZWF0ZU5ld1Bhc3N3b3JkLmh0bWxcIixcclxuICAgICAgICAgICAgICAgIHJlc3RyaWN0OiBcIkVcIixcclxuICAgICAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBzY29wZTogeyBvcHRpb25zOiBcIiZcIiB9LFxyXG4gICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50cywgYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBVc2VySW5mbztcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5jcmVhdGVOZXdQYXNzd29yZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbihcIlVzZXJJbmZvMVwiLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJbmZvID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2VtYWlsaWQgPSBVc2VySW5mby5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oXCJFbWFpbFwiLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc2V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNlZW1haWxpZCA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUucmVzZW5kb3RwID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS52YWxpZGF0ZXJlc2VuZG90cCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGFuZ2VwYXNzd29yZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hhbmdlcGFzc3dvcmRzdWJtaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoc2NvcGUub3B0aW9ucywge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmVGdW5jdGlvbjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGFuZ2VwYXNzZm9ybS4kc2V0UHJpc3RpbmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2VtYWlsaWQgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2VlbWFpbGlkID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNwYXNzd29yZCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jb25wYXNzd29yZCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vdHAgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudmFsaWRhdGVyZXNlbmRvdHAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3BlLmNlbWFpbGlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoc2NvcGUuY2VtYWlsaWQpID09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBFbWFpbCBJZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KFwiL3NlbmRtYWlsXCIsIHsgXCJFbWFpbElkXCI6IHNjb3BlLmNlbWFpbGlkLCBcIlVzZXJJZFwiOiBVc2VySW5mby51c2VyaWQgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gJ3N1Y3Nlc3MnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyRyb290U2NvcGUuJGJyb2FkY2FzdCgnVXNlckluZm8xJywgVXNlckluZm8pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoJ1ZlcmlmaWNhdGlvbiBNYWlsIFJlIFNlbmQgU3Vjc2Vzc2Z1bCcpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7IGFsZXJ0KCdWZXJpZmljYXRpb24gTWFpbCBSZSBTZW5kIEZhaWwnKSB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2FuY2VsbWFpbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2dpbnNob3cnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hhbmdlcGFzc3dvcmRzdWJtaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KFwiL3Jlc2V0cGFzc3dvcmRcIiwgeyBcIkVtYWlsSWRcIjogc2NvcGUuY2VtYWlsaWQsIFwiVXNlcklkXCI6IFVzZXJJbmZvLnVzZXJpZCwgXCJwYXNzd29yZFwiOiBzY29wZS5jb25wYXNzd29yZCwgXCJPdHBDb2RlXCI6IHNjb3BlLm90cCB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS50b1N0cmluZygpID09ICdzdWNzZXNzJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdsb2dpbnNob3cnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdSZXNldCBQYXNzd29yZCBTdWNzZXNzZnVsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXNwb25zZS5kYXRhLnRvU3RyaW5nKCkgPT0gJ0V4cGlyZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdPVFAgSXMgRXhwaXJlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyBhbGVydCgnUmVzZXQgUGFzc3dvcmQgRmFpbCcpIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBhcHAuY29udHJvbGxlcignbXlDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRsb2csICRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmRpck9wdGlvbnMgPSB7fTtcclxuICAgICAgICAgICAgJHNjb3BlLmNhbGxEaXJGdW5jID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoJHNjb3BlLnVzZXJpZCkgPT0gJ3VuZGVmaW5lZCcgfHwgJHNjb3BlLnVzZXJpZCA9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tc2cgPSAnVXNlcklkIGlzIFJlcXVpcmVkJztcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZm9yZ290ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRpck9wdGlvbnMuZGlyZWN0aXZlRnVuY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2dpbnNob3cgPSBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJHNjb3BlLiRvbihcImxvZ2luc2hvd1wiLCBmdW5jdGlvbiAoZXZ0LCBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBVc2VySW5mbyA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9naW5zaG93ID0gVXNlckluZm87XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuJG9uKFwiZm9yZ290Y2FuY2VsXCIsIGZ1bmN0aW9uIChldnQsIGRhdGEpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubG9naW5zaG93ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICRzY29wZS5sb2dpbnNob3cgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUuaXNsb2dpbkRpc2FibGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUuaXNNdWx0aXJvbGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLmNsdXN0ZXJzID0gW107XHJcbiAgICAgICAgICAgICRzY29wZS51c2VyY2x1c3RlciA9IFwiXCI7XHJcbiAgICAgICAgICAgICRzY29wZS5sYXN0bG9naW4gPSBcIlwiO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9yZ290ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuVmFsaWRhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmlzTXVsdGlyb2xlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKCRzY29wZS5zZWxlY3RlZHJvbGUpID09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIHNlbGVjdCByb2xlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJChcIiN1c2Vycm9sZVwiKS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KFwiL3ZhbGlkYXRlXCIsIHsgXCJ1c2VyaWRcIjogJHNjb3BlLnVzZXJpZCwgXCJwYXNzXCI6ICRzY29wZS5wYXNzIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdnZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9nLmluZm8ocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT0gXCIxXCIgfHwgcmVzcG9uc2UuZGF0YSA9PSBcIjJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBwYXNzd29yZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiI3Bhc3NcIikuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXNwb25zZS5kYXRhID09IFwiM1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJBbm90aGVyIFVzZXIgaXMgYWxyZWFkeSBsb2dnZWQgSW4sIGtpbmRseSBjbG9zZSB0aGUgY3VycmVudCBzZXNzaW9uIG9yIHVzZSBhbm90aGVyIGJyb3dzZXIuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb2xlaWQnKS52YWx1ZSA9ICRzY29wZS5zZWxlY3RlZHJvbGUuUm9sZWlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyb2xlbmFtZScpLnZhbHVlID0gJHNjb3BlLnNlbGVjdGVkcm9sZS5Sb2xlbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKFwiI2xvZ2luRm9ybVwiKS5zdWJtaXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgnY29ubmVjdGVkdXNlcicsICRzY29wZS51c2VyaWQsICRzY29wZS51c2VyY2x1c3RlciwgJHNjb3BlLmxhc3Rsb2dpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJHNjb3BlLkdldFVzZXJSb2xlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoJHNjb3BlLnVzZXJpZCkgIT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubXNnID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLnBvc3QoXCIvRmV0Y2hVc2VySW5mb1wiLCB7IFwidXNlcmlkXCI6ICRzY29wZS51c2VyaWQgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhID09IFwiMVwiIHx8IHJlc3BvbnNlLmRhdGEgPT0gXCIyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJJbnZhbGlkIHVzZXIgaWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnVXNlckluZm8nLCByZXNwb25zZS5kYXRhWzBdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmZvcmdvdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubGFzdGxvZ2luID0gcmVzcG9uc2UuZGF0YVswXS5sYXN0bG9naW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jbHVzdGVycyA9IHJlc3BvbnNlLmRhdGFbMF0uY2x1c3RlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhWzBdLnJvbGUubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc011bHRpcm9sZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzbG9naW5EaXNhYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2VsZWN0ZWRyb2xlID0gcmVzcG9uc2UuZGF0YVswXS5yb2xlWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlLmRhdGFbMF0ucm9sZS5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNNdWx0aXJvbGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLlVzZXJSb2xlcyA9IHJlc3BvbnNlLmRhdGFbMF0ucm9sZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc2xvZ2luRGlzYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyY2x1c3RlciA9IEdldFVzZXJDbHVzdGVyKCRzY29wZS5jbHVzdGVycyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBmdW5jdGlvbiBHZXRVc2VyQ2x1c3RlcihjbHVzdGVycykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJjbHVzdGVycyA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICBjbHVzdGVycy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VyY2x1c3RlcnMgPT0gXCJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcmNsdXN0ZXJzID0gaXRlbTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJjbHVzdGVycyA9IHVzZXJjbHVzdGVycyArIFwiLFwiICsgaXRlbTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVzZXJjbHVzdGVycztcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICBcclxuIl19
